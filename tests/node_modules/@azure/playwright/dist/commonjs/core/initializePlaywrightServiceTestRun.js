"use strict";
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT License.
Object.defineProperty(exports, "__esModule", { value: true });
exports.initializePlaywrightServiceTestRun = initializePlaywrightServiceTestRun;
const playwrightServiceApicall_js_1 = require("../utils/playwrightServiceApicall.js");
const playwrightServiceConfig_js_1 = require("../common/playwrightServiceConfig.js");
const utils_js_1 = require("../utils/utils.js");
const cIInfoProvider_js_1 = require("../utils/cIInfoProvider.js");
/**
 * Initializes the Playwright workspaces by setting up authentication and creating a test run.
 *
 * @param config - The full Playwright configuration
 * @returns Promise that resolves when service initialization is complete
 */
async function initializePlaywrightServiceTestRun(config) {
    const playwrightServiceApiClient = new playwrightServiceApicall_js_1.PlaywrightServiceApiCall();
    const ciConfigInfo = cIInfoProvider_js_1.CIInfoProvider.getCIInfo();
    const playwrightServiceConfig = playwrightServiceConfig_js_1.PlaywrightServiceConfig.instance;
    const testRunCreatePayload = {
        displayName: playwrightServiceConfig.runName === ""
            ? playwrightServiceConfig.runId
            : playwrightServiceConfig.runName,
        config: (0, utils_js_1.getTestRunConfig)(config),
        ciConfig: ciConfigInfo,
    };
    // Create/update test run in the service
    await playwrightServiceApiClient.patchTestRunAPI(testRunCreatePayload);
}
//# sourceMappingURL=initializePlaywrightServiceTestRun.js.map